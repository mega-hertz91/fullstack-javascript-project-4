import{o as e,t}from"./chunk-N2sQUAeg.js";var n=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},r=class{constructor({batchSize:e,timeout:t,executeBatch:n,setTimeout:r,clearTimeout:i,baseDelay:a,retries:o}){this.queue=[],this.batchSize=e,this.timeout=t,this.timeoutHandle=null,this.executeBatch=n,this.setTimeout=r,this.clearTimeout=i,this.pending=null,this.baseDelay=a??500,this.retries=o??5}submit(e){this.queue.push(e),this.queue.length>=this.batchSize?this.flush():this.queue.length===1&&this.startTimer()}startTimer(){this.timeoutHandle=this.setTimeout(()=>this.flush(),this.timeout)}clearTimer(){this.timeoutHandle&&=(this.clearTimeout(this.timeoutHandle),null)}flush(){return n(this,void 0,void 0,function*(){if(this.clearTimer(),this.queue.length!==0){if(this.pending)return this.pending;try{this.pending=this.flushInner(),yield this.pending}catch(e){throw e}finally{this.pending=null}}})}flushInner(){return n(this,void 0,void 0,function*(){for(;this.queue.length>0;){let e=this.queue.slice(0,this.batchSize);this.queue=this.queue.slice(this.batchSize),yield this.executeBatchWithRetry(e)}})}executeBatchWithRetry(e){return n(this,void 0,void 0,function*(){yield this.retryWithExponentialBackoff(()=>n(this,void 0,void 0,function*(){yield this.executeBatch(e)}))})}retryWithExponentialBackoff(e){return n(this,void 0,void 0,function*(){let t=Math.max(0,this.retries);for(let n=0;n<=t;n++)try{return yield e()}catch(e){if(n===t)throw e;let r=this.baseDelay*2**n;yield new Promise(e=>setTimeout(e,r))}throw Error(`This line should never be reached`)})}},i=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const o={Identify:`identify`,Track:`track`,Page:`page`,Screen:`screen`},s={Subscribe:`Subscribe`,Unsubscribe:`Unsubscribe`},c={MessageSent:`DFInternalMessageSent`,BadWorkspaceConfiguration:`DFBadWorkspaceConfiguration`,MessageFailure:`DFMessageFailure`,MessageSkipped:`DFMessageSkipped`,SegmentBroadcast:`DFSegmentBroadcast`,SubscriptionChange:`DFSubscriptionChange`,EmailDropped:`DFEmailDropped`,EmailDelivered:`DFEmailDelivered`,EmailOpened:`DFEmailOpened`,EmailClicked:`DFEmailClicked`,EmailBounced:`DFEmailBounced`,EmailMarkedSpam:`DFEmailMarkedSpam`,SmsDelivered:`DFSmsDelivered`,SmsFailed:`DFSmsFailed`,JourneyNodeProcessed:`DFJourneyNodeProcessed`,ManualSegmentUpdate:`DFManualSegmentUpdate`,AttachedFiles:`DFAttachedFiles`,UserTrackSignal:`DFUserTrackSignal`,GroupUserAssignment:`DFGroupUserAssignment`,UserGroupAssignment:`DFUserGroupAssignment`};var l=class{constructor({issueRequest:e,writeKey:t,host:n=`https://app.dittofeed.com`,uuid:a,setTimeout:o,clearTimeout:s,baseDelay:c,retries:l}){this.batchQueue=new r({timeout:500,batchSize:5,setTimeout:o,clearTimeout:s,baseDelay:c,retries:l,executeBatch:r=>i(this,void 0,void 0,function*(){yield e({batch:r},{writeKey:t,host:n})})}),this.uuid=a}identify(e){let t=Object.assign(Object.assign({},e),{messageId:e.messageId??this.uuid(),type:o.Identify});this.batchQueue.submit(t)}track(e){let t=Object.assign(Object.assign({},e),{messageId:e.messageId??this.uuid(),type:o.Track});this.batchQueue.submit(t)}page(e){let t=Object.assign(Object.assign({},e),{messageId:e.messageId??this.uuid(),type:o.Page});this.batchQueue.submit(t)}screen(e){let t=Object.assign(Object.assign({},e),{messageId:e.messageId??this.uuid(),type:o.Screen});this.batchQueue.submit(t)}subscribe(e){let{messageId:t,subscriptionGroupId:n}=e,r=a(e,[`messageId`,`subscriptionGroupId`]),i=Object.assign(Object.assign({},r),{messageId:t??this.uuid(),type:o.Track,event:c.SubscriptionChange,properties:{subscriptionId:n,action:s.Subscribe}});this.batchQueue.submit(i)}unsubscribe(e){let{messageId:t,subscriptionGroupId:n}=e,r=a(e,[`messageId`,`subscriptionGroupId`]),i=Object.assign(Object.assign({},r),{messageId:t??this.uuid(),type:o.Track,event:c.SubscriptionChange,properties:{subscriptionId:n,action:s.Unsubscribe}});this.batchQueue.submit(i)}flush(){return i(this,void 0,void 0,function*(){yield this.batchQueue.flush()})}},u,d=new Uint8Array(16);function f(){if(!u&&(u=typeof crypto<`u`&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!u))throw Error(`crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported`);return u(d)}var p=[];for(let e=0;e<256;++e)p.push((e+256).toString(16).slice(1));function m(e,t=0){return p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+`-`+p[e[t+4]]+p[e[t+5]]+`-`+p[e[t+6]]+p[e[t+7]]+`-`+p[e[t+8]]+p[e[t+9]]+`-`+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]}var h={randomUUID:typeof crypto<`u`&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function g(e,t,n){if(h.randomUUID&&!t&&!e)return h.randomUUID();e||={};let r=e.random||(e.rng||f)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n||=0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return m(r)}var _=g,v=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},y=class e{static createBaseSdk(e){return new l(Object.assign({uuid:()=>_(),issueRequest:(e,{host:t=`https://dittofeed.com`,writeKey:n})=>v(this,void 0,void 0,function*(){let r=`${t}/api/public/apps/batch`,i={authorization:n,"Content-Type":`application/json`},a=yield fetch(r,{method:`POST`,headers:i,body:JSON.stringify(e)});if(!a.ok)throw Error(`HTTP error! status: ${a.status}`)}),setTimeout:(e,t)=>window.setTimeout(e,t),clearTimeout:e=>window.clearTimeout(e)},e))}static init(t){return v(this,void 0,void 0,function*(){return e.instance||=new e(this.createBaseSdk(t),t.logger),e.instance})}static initNew(t){return v(this,void 0,void 0,function*(){return new e(this.createBaseSdk(t),t.logger)})}constructor(e,t){this.anonymousId=null,this.logger=null,this.baseSdk=e,this.logger=t??null}static identify(e){if(this.instance)return this.instance.identify(e)}identify(e){let t;return t=!(`userId`in e)&&!(`anonymousId`in e)?Object.assign(Object.assign({},e),{anonymousId:this.getAnonymousId()}):e,this.baseSdk.identify(t)}static track(e){if(this.instance)return this.instance.track(e)}track(e){let t;return t=!(`anonymousId`in e)&&!(`userId`in e)?Object.assign(Object.assign({},e),{anonymousId:this.getAnonymousId()}):e,this.baseSdk.track(t)}static page(e){if(this.instance)return this.instance.page(e)}page(e){let t;return t=!(`anonymousId`in e)&&!(`userId`in e)?Object.assign(Object.assign({},e),{anonymousId:this.getAnonymousId()}):e,this.baseSdk.page(t)}static screen(e){if(this.instance)return this.instance.screen(e)}screen(e){let t;return t=!(`anonymousId`in e)&&!(`userId`in e)?Object.assign(Object.assign({},e),{anonymousId:this.getAnonymousId()}):e,this.baseSdk.screen(t)}static subscribe(e){if(this.instance)return this.instance.subscribe(e)}subscribe(e){let t;return t=!(`anonymousId`in e)&&!(`userId`in e)?Object.assign(Object.assign({},e),{anonymousId:this.getAnonymousId()}):e,this.baseSdk.subscribe(t)}static unsubscribe(e){if(this.instance)return this.instance.unsubscribe(e)}unsubscribe(e){let t;return t=!(`anonymousId`in e)&&!(`userId`in e)?Object.assign(Object.assign({},e),{anonymousId:this.getAnonymousId()}):e,this.baseSdk.unsubscribe(t)}static flush(){if(this.instance)return this.instance.flush()}flush(){return this.baseSdk.flush()}static getAnonymousId(){if(!this.instance)throw Error(`DittofeedSdk not initialized`);return this.instance.getAnonymousId()}getAnonymousId(){if(!this.anonymousId){let e=this.retrieveStoredAnonymousId(),t;e?t=e:(t=_(),this.storeAnonymousId(t)),this.anonymousId=t}return this.anonymousId}static resetAnonymousId(){if(!this.instance)throw Error(`DittofeedSdk not initialized`);return this.instance.resetAnonymousId()}resetAnonymousId(){return this.anonymousId&&this.deleteAnonymousId(),this.getAnonymousId()}retrieveStoredAnonymousId(){var t,n;if(!e.isBrowserEnvironment())return null;let r=document.cookie.split(`;`);for(let t of r){let n=t.trim().split(`=`);if(n.length>=2&&n[0]===e.ANONYMOUS_ID&&n[1]!==void 0)return decodeURIComponent(n[1])}try{let t=localStorage.getItem(e.ANONYMOUS_ID);if(t)return t}catch(e){(t=this.logger)==null||t.warn(`Failed to access localStorage:`,e)}try{let t=sessionStorage.getItem(e.ANONYMOUS_ID);if(t)return t}catch(e){(n=this.logger)==null||n.warn(`Failed to access sessionStorage:`,e)}return null}storeAnonymousId(t){var n,r,i;if(!e.isBrowserEnvironment())return;let a=new Date;a.setFullYear(a.getFullYear()+2);let o=encodeURIComponent(t),s=`${e.ANONYMOUS_ID}=${o};expires=${a.toUTCString()};path=/;SameSite=Lax`;try{document.cookie=s}catch(e){(n=this.logger)==null||n.warn(`Failed to set cookie:`,e)}try{localStorage.setItem(e.ANONYMOUS_ID,t)}catch(e){(r=this.logger)==null||r.warn(`Failed to access localStorage:`,e)}try{sessionStorage.setItem(e.ANONYMOUS_ID,t)}catch(e){(i=this.logger)==null||i.warn(`Failed to access sessionStorage:`,e)}}deleteAnonymousId(){var t,n,r;if(this.anonymousId=null,e.isBrowserEnvironment()){try{document.cookie=`${e.ANONYMOUS_ID}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;SameSite=Lax`}catch(e){(t=this.logger)==null||t.warn(`Failed to delete cookie:`,e)}try{localStorage.removeItem(e.ANONYMOUS_ID)}catch(e){(n=this.logger)==null||n.warn(`Failed to access localStorage:`,e)}try{sessionStorage.removeItem(e.ANONYMOUS_ID)}catch(e){(r=this.logger)==null||r.warn(`Failed to access sessionStorage:`,e)}}}static isBrowserEnvironment(){return typeof window<`u`&&typeof document<`u`}};y.instance=null,y.ANONYMOUS_ID=`DfAnonymousId`;var ee=e=>({name:`dittofeed`,config:{enabled:!0,...e},initialize:({config:t})=>{t.enabled&&y.init(e.sdkInit)},loaded:({config:e})=>!!e.enabled,identify:async({payload:e})=>{await y.identify({userId:e?.userId,traits:e?.traits??e?.properties??{}})},track:async({payload:e})=>{await y.track({userId:e?.userId,event:e?.event??e?.name,properties:e?.properties??{}})},page:async({payload:e})=>{let t=e?.name??e?.properties?.name??(typeof document<`u`?document.title:void 0);await y.page({userId:e?.userId,name:t,properties:e?.properties??{}})}});function b(e){let t={enabled:!0},n=()=>typeof window>`u`||typeof document>`u`?!1:typeof window.ym==`function`,r=e=>!!e.enabled&&n();return{name:`yandexMetrika`,config:{...t,...e},initialize({config:e}){if(!(!e.enabled||n())){if(!e.counterId)throw Error(`YandexMetrikaPlugin: counterId is required.`);((e,t,n,r,i)=>{e[i]??(e[i]=function(...t){var n;e.ym&&((n=e.ym).a??(n.a=[]),e.ym.a.push(t))}),e[i].l=new Date().getTime();let a=t.createElement(n),o=t.getElementsByTagName(n)[0];a.async=!0,a.src=r,o.parentNode?.insertBefore(a,o)})(window,document,`script`,`https://mc.yandex.ru/metrika/tag.js`,`ym`),window.ym??(window.ym=(...e)=>{var t;((t=window.ym).a??(t.a=[])).push(e)}),window.ym(e.counterId,`init`,{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})}},loaded(){return n()},track:({payload:e,config:t})=>{if(!r(t))return;let n=t.mapEvents||{},i=n[e.event]||e.event;t.dev&&!n[e.event]&&console.warn(`[YandexMetrika] No mapped goal for event "${e.event}", sending as-is`),window.ym(t.counterId,`reachGoal`,i,e.properties)},page:({payload:e,config:t})=>{if(!r(t))return;let{properties:n={}}=e,i=n.url??window.location.href;window.ym(t.counterId,`hit`,i,n)},identify:({payload:e,config:t})=>{if(!r(t))return;let n=e.traits;if(window.ym(t.counterId,`setUserID`,e.userId),n&&Object.keys(n).length>0){window.ym(t.counterId,`userParams`,{...n,UserID:e.userId});let r={};n.email&&(r.email=n.email),n.phone_number&&(r.phone_number=n.phone_number),n.first_name&&(r.first_name=n.first_name),n.last_name&&(r.last_name=n.last_name),n.yandex_cid&&(r.yandex_cid=n.yandex_cid),window.ym(t.counterId,`firstPartyParams`,r)}}}}var te=t(((e,t)=>{(function(n,r){typeof e==`object`&&t!==void 0?t.exports=function(e,t,n,r,i){for(t=t.split?t.split(`.`):t,r=0;r<t.length;r++)e=e?e[t[r]]:i;return e===i?n:e}:typeof define==`function`&&define.amd?define(function(){return function(e,t,n,r,i){for(t=t.split?t.split(`.`):t,r=0;r<t.length;r++)e=e?e[t[r]]:i;return e===i?n:e}}):n.dlv=function(e,t,n,r,i){for(t=t.split?t.split(`.`):t,r=0;r<t.length;r++)e=e?e[t[r]]:i;return e===i?n:e}})(e)})),ne=`function`,re=`string`,x=`undefined`,ie=`boolean`,ae=`array`,oe=`symbol`,se=`null`,S=`form`,C=`input`,ce=`button`,le=`select`,ue=typeof process<`u`?process:{};ue.env&&ue.env.NODE_ENV;var w=typeof document!==x;w&&window.location.hostname,ue.versions!=null&&ue.versions.node,typeof Deno<`u`&&Deno.core,typeof self==`object`&&self.constructor&&self.constructor.name,w&&window.name===`nodejs`||typeof navigator<`u`&&navigator.userAgent!==void 0&&(navigator.userAgent.includes(`Node.js`)||navigator.userAgent.includes(`jsdom`));function de(e,t){return t.charAt(0)[e]()+t.slice(1)}var fe=de.bind(null,`toUpperCase`),pe=de.bind(null,`toLowerCase`);function me(e){return _e(e)?fe(se):typeof e==`object`?xe(e):Object.prototype.toString.call(e).slice(8,-1)}function he(e,t){t===void 0&&(t=!0);var n=me(e);return t?pe(n):n}function T(e,t){return typeof t===e}var E=T.bind(null,ne),D=T.bind(null,re),O=T.bind(null,x),ge=T.bind(null,ie);T.bind(null,oe);function _e(e){return e===null}function ve(e){return he(e)===`number`&&!isNaN(e)}function ye(e){return he(e)===ae}function k(e){if(!be(e))return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function be(e){return e&&(typeof e==`object`||e!==null)}function xe(e){return E(e.constructor)?e.constructor.name:null}function Se(e){return e instanceof Error||D(e.message)&&e.constructor&&ve(e.constructor.stackTraceLimit)}function Ce(e,t){if(typeof t!=`object`||_e(t))return!1;if(t instanceof e)return!0;var n=he(new e(``));if(Se(t))for(;t;){if(he(t)===n)return!0;t=Object.getPrototypeOf(t)}return!1}Ce.bind(null,TypeError),Ce.bind(null,SyntaxError);function we(e,t){var n=e instanceof Element||e instanceof HTMLDocument;return n&&t?Te(e,t):n}function Te(e,t){return t===void 0&&(t=``),e&&e.nodeName===t.toUpperCase()}function Ee(e){var t=[].slice.call(arguments,1);return function(){return e.apply(void 0,[].slice.call(arguments).concat(t))}}Ee(we,S),Ee(we,ce),Ee(we,C),Ee(we,le);var De=e(te(),1);function Oe(e){try{return decodeURIComponent(e.replace(/\+/g,` `))}catch{return null}}function ke(){if(w){var e=navigator,t=e.languages;return e.userLanguage||(t&&t.length?t[0]:e.language)}}function Ae(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{}}function je(e){return function(e){for(var t,n=Object.create(null),r=/([^&=]+)=?([^&]*)/g;t=r.exec(e);){var i=Oe(t[1]),a=Oe(t[2]);if(i)if(i.substring(i.length-2)===`[]`){var o=n[i=i.substring(0,i.length-2)]||(n[i]=[]);n[i]=Array.isArray(o)?o:[],n[i].push(a)}else n[i]=a===``||a}for(var s in n){var c=s.split(`[`);c.length>1&&(Me(n,c.map(function(e){return e.replace(/[?[\]\\ ]/g,``)}),n[s]),delete n[s])}return n}(function(e){if(e){var t=e.match(/\?(.*)/);return t&&t[1]?t[1].split(`#`)[0]:``}return w&&window.location.search.substring(1)}(e))}function Me(e,t,n){for(var r=t.length-1,i=0;i<r;++i){var a=t[i];if(a===`__proto__`||a===`constructor`)break;a in e||(e[a]={}),e=e[a]}e[t[r]]=n}function Ne(){for(var e=``,t=0,n=4294967295*Math.random()|0;t++<36;){var r=`xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx`[t-1],i=15&n;e+=r==`-`||r==`4`?r:(r==`x`?i:3&i|8).toString(16),n=t%8==0?4294967295*Math.random()|0:n>>4}return e}var Pe=`global`,A=`__`+Pe+`__`,j=typeof self==`object`&&self.self===self&&self||typeof global==`object`&&global.global===global&&global||void 0;function M(e){return j[A][e]}function N(e,t){return j[A][e]=t}function P(e){delete j[A][e]}function F(e,t,n){var r;try{if(Ie(e)){var i=window[e];r=i[t].bind(i)}}catch{}return r||n}j[A]||(j[A]={});var Fe={};function Ie(e){if(Fe[e]!==void 0)return Fe[e];try{var t=window[e];t.setItem(x,x),t.removeItem(x)}catch{return Fe[e]=!1}return Fe[e]=!0}function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I.apply(null,arguments)}var L=`function`,R=`undefined`,z=`reducer`,Le=`@@redux/`,Re=Le+`INIT`,ze=Le+Math.random().toString(36),Be=function(){return typeof Symbol===L&&Symbol.observable||`@@observable`}(),Ve=` != `+L;function He(e,t,n){var r;if(typeof t===L&&typeof n===R&&(n=t,t=void 0),typeof n!==R){if(typeof n!==L)throw Error(`enhancer`+Ve);return n(He)(e,t)}if(typeof e!==L)throw Error(z+Ve);var i=e,a=t,o=[],s=o,c=!1;function l(){s===o&&(s=o.slice())}function u(){return a}function d(e){if(typeof e!==L)throw Error(`Listener`+Ve);var t=!0;return l(),s.push(e),function(){if(t){t=!1,l();var n=s.indexOf(e);s.splice(n,1)}}}function f(e){if(!k(e))throw Error(`Act != obj`);if(typeof e.type===R)throw Error(`ActType `+R);if(c)throw Error(`Dispatch in `+z);try{c=!0,a=i(a,e)}finally{c=!1}for(var t=o=s,n=0;n<t.length;n++)(0,t[n])();return e}return f({type:Re}),(r={dispatch:f,subscribe:d,getState:u,replaceReducer:function(e){if(typeof e!==L)throw Error(`next `+z+Ve);i=e,f({type:Re})}})[Be]=function(){var e,t=d;return(e={subscribe:function(e){if(typeof e!=`object`)throw TypeError(`Observer != obj`);function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[Be]=function(){return this},e},r}function Ue(e,t){var n=t&&t.type;return`action `+(n&&n.toString()||`?`)+z+` `+e+` returns `+R}function B(){var e=[].slice.call(arguments);return e.length===0?function(e){return e}:e.length===1?e[0]:e.reduce(function(e,t){return function(){return e(t.apply(void 0,[].slice.call(arguments)))}})}function We(){var e=arguments;return function(t){return function(n,r,i){var a,o=t(n,r,i),s=o.dispatch,c={getState:o.getState,dispatch:function(e){return s(e)}};return a=[].slice.call(e).map(function(e){return e(c)}),I({},o,{dispatch:s=B.apply(void 0,a)(o.dispatch)})}}}var V=`__anon_id`,H=`__user_id`,U=`__user_traits`,Ge=`analytics`,W=`userId`,G=`anonymousId`,Ke=`bootstrap.params.campaign.initializeStart.initialize.initializeEnd.ready.resetStart.reset.resetEnd.pageStart.page.pageEnd.pageAborted.trackStart.track.trackEnd.trackAborted.identifyStart.identify.identifyEnd.identifyAborted.userIdChanged.registerPlugins.enablePlugin.disablePlugin.online.offline.setItemStart.setItem.setItemEnd.setItemAborted.removeItemStart.removeItem.removeItemEnd.removeItemAborted`.split(`.`),qe=[`name`,`EVENTS`,`config`,`loaded`],K=Ke.reduce(function(e,t){return e[t]=t,e},{registerPluginType:function(e){return`registerPlugin:`+e},pluginReadyType:function(e){return`ready:`+e}}),Je=/^utm_/,Ye=/^an_prop_/,Xe=/^an_trait_/;function Ze(e){var t=e.storage.setItem;return function(n){return function(r){return function(i){if(i.type===K.bootstrap){var a=i.params,o=i.user,s=i.persistedUser,c=i.initialUser,l=s.userId===o.userId;s.anonymousId!==o.anonymousId&&t(V,o.anonymousId),l||t(H,o.userId),c.traits&&t(U,I({},l&&s.traits?s.traits:{},c.traits));var u=Object.keys(i.params);if(u.length){var d=a.an_uid,f=a.an_event,p=u.reduce(function(e,t){if(t.match(Je)||t.match(/^(d|g)clid/)){var n=t.replace(Je,``);e.campaign[n===`campaign`?`name`:n]=a[t]}return t.match(Ye)&&(e.props[t.replace(Ye,``)]=a[t]),t.match(Xe)&&(e.traits[t.replace(Xe,``)]=a[t]),e},{campaign:{},props:{},traits:{}});n.dispatch(I({type:K.params,raw:a},p,d?{userId:d}:{})),d&&setTimeout(function(){return e.identify(d,p.traits)},0),f&&setTimeout(function(){return e.track(f,p.props)},0),Object.keys(p.campaign).length&&n.dispatch({type:K.campaign,campaign:p.campaign})}}return r(i)}}}}function Qe(e){return function(t,n){if(t===void 0&&(t={}),n===void 0&&(n={}),n.type===K.setItemEnd){if(n.key===V)return I({},t,{anonymousId:n.value});if(n.key===H)return I({},t,{userId:n.value})}switch(n.type){case K.identify:return Object.assign({},t,{userId:n.userId,traits:I({},t.traits,n.traits)});case K.reset:return[H,V,U].forEach(function(t){e.removeItem(t)}),Object.assign({},t,{userId:null,anonymousId:null,traits:{}});default:return t}}}function $e(e){return{userId:e.getItem(H),anonymousId:e.getItem(V),traits:e.getItem(U)}}var et=function(e){return`__TEMP__`+e};function tt(e){var t=e.storage,n=t.setItem,r=t.removeItem,i=t.getItem;return function(e){return function(t){return function(a){var o=a.userId,s=a.traits,c=a.options;if(a.type===K.reset&&([H,U,V].forEach(function(e){r(e)}),[W,G,`traits`].forEach(function(e){P(et(e))})),a.type===K.identify){i(V)||n(V,Ne());var l=i(H),u=i(U)||{};l&&l!==o&&e.dispatch({type:K.userIdChanged,old:{userId:l,traits:u},new:{userId:o,traits:s},options:c}),o&&n(H,o),s&&n(U,I({},u,s))}return t(a)}}}}var q={};function nt(e,t){q[e]&&E(q[e])&&(q[e](t),delete q[e])}function rt(e,t,n){return new Promise(function(r,i){return t()?r(e):n<1?i(I({},e,{queue:!0})):new Promise(function(e){return setTimeout(e,10)}).then(function(a){return rt(e,t,n-10).then(r,i)})})}function it(e){return{abort:e}}function at(e,t,n){var r={},i=t(),a=e.getState(),o=a.plugins,s=a.queue,c=a.user;if(!a.context.offline&&s&&s.actions&&s.actions.length){var l=s.actions.reduce(function(e,t,n){return o[t.plugin].loaded?(e.process.push(t),e.processIndex.push(n)):(e.requeue.push(t),e.requeueIndex.push(n)),e},{processIndex:[],process:[],requeue:[],requeueIndex:[]});l.processIndex&&l.processIndex.length&&(l.processIndex.forEach(function(t){var a=s.actions[t],l=a.plugin,u=a.payload.type,d=i[l][u];if(d&&E(d)){var f,p=function(e,t){return e===void 0&&(e={}),t===void 0&&(t={}),[W,G].reduce(function(n,r){return e.hasOwnProperty(r)&&t[r]&&t[r]!==e[r]&&(n[r]=t[r]),n},e)}(a.payload,c),m=r[p.meta.rid];if(!m&&(f=d({payload:p,config:o[l].config,instance:n,abort:it}))&&k(f)&&f.abort)return void(r[p.meta.rid]=!0);if(!m){var h=u+`:`+l;e.dispatch(I({},p,{type:h,_:{called:h,from:`queueDrain`}}))}}}),s.actions=s.actions.filter(function(e,t){return!~l.processIndex.indexOf(t)}))}}var ot=function(e){var t=e.data,n=e.action,r=e.instance,i=e.state,a=e.allPlugins,o=e.allMatches,s=e.store,c=e.EVENTS;try{var l=i.plugins,u=i.context,d=n.type,f=d.match(J),p=t.exact.map(function(e){return e.pluginName});f&&(p=o.during.map(function(e){return e.pluginName}));var m=function(e,t){return function(n,r,i){var a=r.config,o=r.name,s=o+`.`+n.type;i&&(s=i.event);var c=n.type.match(J)?function(e,t,n,r,i){return function(a,o){var s=r?r.name:e,c=o&&Y(o)?o:n;if(r&&(!(c=o&&Y(o)?o:[e]).includes(e)||c.length!==1))throw Error(`Method `+t+` can only abort `+e+` plugin. `+JSON.stringify(c)+` input valid`);return I({},i,{abort:{reason:a,plugins:c,caller:t,_:s}})}}(o,s,t,i,n):function(e,t){return function(){throw Error(e.type+` action not cancellable. Remove abort in `+t)}}(n,s);return{payload:_t(n),instance:e,config:a||{},abort:c}}}(r,p),h=t.exact.reduce(function(e,t){var n=t.pluginName,r=t.methodName,i=!1;return r.match(/^initialize/)||r.match(/^reset/)||(i=!l[n].loaded),u.offline&&r.match(/^(page|track|identify)/)&&(i=!0),e[``+n]=i,e},{});return Promise.resolve(t.exact.reduce(function(e,i,o){var s=i.pluginName;return Promise.resolve(e).then(function(e){function i(){return Promise.resolve(e)}var o=function(){if(t.namespaced&&t.namespaced[s])return Promise.resolve(t.namespaced[s].reduce(function(e,t,n){return Promise.resolve(e).then(function(e){return t.method&&E(t.method)?(function(e,t){var n=gt(e);if(n&&n.name===t){var r=gt(n.method);throw Error([t+` plugin is calling method `+e,`Plugins cant call self`,`Use `+n.method+` `+(r?`or `+r.method:``)+` in `+t+` plugin insteadof `+e].join(`
`))}}(t.methodName,t.pluginName),Promise.resolve(t.method({payload:e,instance:r,abort:(n=e,i=s,o=t.pluginName,function(e,t){return I({},n,{abort:{reason:e,plugins:t||[i],caller:d,from:o||i}})}),config:ut(t.pluginName,l,a),plugins:l})).then(function(t){var n=k(t)?t:{};return Promise.resolve(I({},e,n))})):e;var n,i,o})},Promise.resolve(n))).then(function(t){e[s]=t});e[s]=n}();return o&&o.then?o.then(i):i()})},Promise.resolve({}))).then(function(e){return Promise.resolve(t.exact.reduce(function(n,i,o){try{var c=t.exact.length===o+1,u=i.pluginName,p=a[u];return Promise.resolve(n).then(function(t){var n=e[u]?e[u]:{};if(f&&(n=t),pt(n,u))return lt({data:n,method:d,instance:r,pluginName:u,store:s}),Promise.resolve(t);if(pt(t,u))return c&&lt({data:t,method:d,instance:r,store:s}),Promise.resolve(t);if(h.hasOwnProperty(u)&&!0===h[u])return s.dispatch({type:`queue`,plugin:u,payload:n,_:{called:`queue`,from:`queueMechanism`}}),Promise.resolve(t);var i=m(e[u],a[u]);return Promise.resolve(p[d]({abort:i.abort,payload:n,instance:r,config:ut(u,l,a),plugins:l})).then(function(i){var a=k(i)?i:{},o=I({},t,a),c=e[u];if(pt(c,u))lt({data:c,method:d,instance:r,pluginName:u,store:s});else{var l=d+`:`+u;(l.match(/:/g)||[]).length<2&&!d.match(st)&&!d.match(ct)&&r.dispatch(I({},f?o:n,{type:l,_:{called:l,from:`submethod`}}))}return Promise.resolve(o)})})}catch(e){return Promise.reject(e)}},Promise.resolve(n))).then(function(e){if(!(d.match(J)||d.match(/^registerPlugin/)||d.match(ct)||d.match(st)||d.match(/^params/)||d.match(/^userIdChanged/))){if(c.plugins.includes(d),e._&&e._.originalAction===d)return e;var n=I({},e,{_:{originalAction:e.type,called:e.type,from:`engineEnd`}});mt(e,t.exact.length)&&!d.match(/End$/)&&(n=I({},n,{type:e.type+`Aborted`})),s.dispatch(n)}return e})})}catch(e){return Promise.reject(e)}},J=/Start$/,st=/^bootstrap/,ct=/^ready/;function lt(e){var t=e.pluginName,n=e.method+`Aborted`+(t?`:`+t:``);e.store.dispatch(I({},e.data,{type:n,_:{called:n,from:`abort`}}))}function ut(e,t,n){var r=t[e]||n[e];return r&&r.config?r.config:{}}function dt(e,t){return t.reduce(function(t,n){return n[e]?t.concat({methodName:e,pluginName:n.name,method:n[e]}):t},[])}function ft(e,t){var n=e.replace(J,``),r=t?`:`+t:``;return[``+e+r,``+n+r,n+`End`+r]}function pt(e,t){var n=e.abort;return!!n&&(!0===n||ht(n,t)||n&&ht(n.plugins,t))}function mt(e,t){var n=e.abort;if(!n)return!1;if(!0===n||D(n))return!0;var r=n.plugins;return Y(n)&&n.length===t||Y(r)&&r.length===t}function Y(e){return Array.isArray(e)}function ht(e,t){return!(!e||!Y(e))&&e.includes(t)}function gt(e){var t=e.match(/(.*):(.*)/);return!!t&&{method:t[1],name:t[2]}}function _t(e){return Object.keys(e).reduce(function(t,n){return n===`type`||(t[n]=k(e[n])?Object.assign({},e[n]):e[n]),t},{})}function vt(e,t,n){var r={};return function(i){return function(a){return function(o){try{var s,c=function(e){return s?e:a(d)},l=o.type,u=o.plugins,d=o;if(o.abort)return Promise.resolve(a(o));if(l===K.enablePlugin&&i.dispatch({type:K.initializeStart,plugins:u,disabled:[],fromEnable:!0,meta:o.meta}),l===K.disablePlugin&&setTimeout(function(){return nt(o.meta.rid,{payload:o})},0),l===K.initializeEnd){var f=t(),p=Object.keys(f),m=p.filter(function(e){return u.includes(e)}).map(function(e){return f[e]}),h=[],g=[],_=o.disabled,v=m.map(function(e){var t=e.loaded,n=e.name,a=e.config;return rt(e,function(){return t({config:a})},1e4).then(function(t){return r[n]||(i.dispatch({type:K.pluginReadyType(n),name:n,events:Object.keys(e).filter(function(e){return!qe.includes(e)})}),r[n]=!0),h=h.concat(n),e}).catch(function(e){if(e instanceof Error)throw Error(e);return g=g.concat(e.name),e})});Promise.all(v).then(function(e){var t={plugins:h,failed:g,disabled:_};setTimeout(function(){p.length===v.length+_.length&&i.dispatch(I({},{type:K.ready},t))},0)})}var y=function(){if(l!==K.bootstrap)return/^ready:([^:]*)$/.test(l)&&setTimeout(function(){return at(i,t,e)},0),Promise.resolve(function(e,t,n,r,i){try{var a=E(t)?t():t,o=e.type,s=o.replace(J,``);if(e._&&e._.called)return Promise.resolve(e);var c=n.getState(),l=(f=a,(p=c.plugins)===void 0&&(p={}),(m=e.options)===void 0&&(m={}),Object.keys(f).filter(function(e){var t=m.plugins||{};return ge(t[e])?t[e]:!1!==t.all&&(!p[e]||!1!==p[e].enabled)}).map(function(e){return f[e]}));o===K.initializeStart&&e.fromEnable&&(l=Object.keys(c.plugins).filter(function(t){var n=c.plugins[t];return e.plugins.includes(t)&&!n.initialized}).map(function(e){return a[e]}));var u=l.map(function(e){return e.name}),d=function(e,t){var n=ft(e).map(function(e){return dt(e,t)});return t.reduce(function(n,r){var i=r.name,a=ft(e,i).map(function(e){return dt(e,t)}),o=a[0],s=a[1],c=a[2];return o.length&&(n.beforeNS[i]=o),s.length&&(n.duringNS[i]=s),c.length&&(n.afterNS[i]=c),n},{before:n[0],beforeNS:{},during:n[1],duringNS:{},after:n[2],afterNS:{}})}(o,l);return Promise.resolve(ot({action:e,data:{exact:d.before,namespaced:d.beforeNS},state:c,allPlugins:a,allMatches:d,instance:n,store:r,EVENTS:i})).then(function(e){function t(){var t=function(){if(o.match(J))return Promise.resolve(ot({action:I({},l,{type:s+`End`}),data:{exact:d.after,namespaced:d.afterNS},state:c,allPlugins:a,allMatches:d,instance:n,store:r,EVENTS:i})).then(function(e){e.meta&&e.meta.hasCallback&&nt(e.meta.rid,{payload:e})})}();return t&&t.then?t.then(function(){return e}):e}if(mt(e,u.length))return e;var l,f=function(){if(o!==s)return Promise.resolve(ot({action:I({},e,{type:s}),data:{exact:d.during,namespaced:d.duringNS},state:c,allPlugins:a,allMatches:d,instance:n,store:r,EVENTS:i})).then(function(e){l=e});l=e}();return f&&f.then?f.then(t):t()})}catch(e){return Promise.reject(e)}var f,p,m}(o,t,e,i,n)).then(function(e){var t=a(e);return s=1,t})}();return Promise.resolve(y&&y.then?y.then(c):c(y))}catch(e){return Promise.reject(e)}}}}}function yt(e){return function(t){return function(t){return function(n){var r=n.type,i=n.key,a=n.value,o=n.options;if(r===K.setItem||r===K.removeItem){if(n.abort)return t(n);r===K.setItem?e.setItem(i,a,o):e.removeItem(i,o)}return t(n)}}}}var bt=function(){var e=this;this.before=[],this.after=[],this.addMiddleware=function(t,n){e[n]=e[n].concat(t)},this.removeMiddleware=function(t,n){var r=e[n].findIndex(function(e){return e===t});r!==-1&&(e[n]=[].concat(e[n].slice(0,r),e[n].slice(r+1)))},this.dynamicMiddlewares=function(t){return function(n){return function(r){return function(i){var a={getState:n.getState,dispatch:function(e){return n.dispatch(e)}},o=e[t].map(function(e){return e(a)});return B.apply(void 0,o)(r)(i)}}}}};function xt(e){return function(t,n){t===void 0&&(t={});var r={};if(n.type===`initialize:aborted`)return t;if(/^registerPlugin:([^:]*)$/.test(n.type)){var i=St(n.type,`registerPlugin`),a=e()[i];if(!a||!i)return t;var o=n.enabled,s=a.config;return r[i]={enabled:o,initialized:!!o&&!a.initialize,loaded:!!o&&!!a.loaded({config:s}),config:s},I({},t,r)}if(/^initialize:([^:]*)$/.test(n.type)){var c=St(n.type,K.initialize),l=e()[c];return l&&c?(r[c]=I({},t[c],{initialized:!0,loaded:!!l.loaded({config:l.config})}),I({},t,r)):t}if(/^ready:([^:]*)$/.test(n.type))return r[n.name]=I({},t[n.name],{loaded:!0}),I({},t,r);switch(n.type){case K.disablePlugin:return I({},t,Ct(n.plugins,!1,t));case K.enablePlugin:return I({},t,Ct(n.plugins,!0,t));default:return t}}}function St(e,t){return e.substring(t.length+1,e.length)}function Ct(e,t,n){return e.reduce(function(e,r){return e[r]=I({},n[r],{enabled:t}),e},n)}function wt(e){try{return JSON.parse(JSON.stringify(e))}catch{}return e}var Tt={last:{},history:[]};function Et(e,t){e===void 0&&(e=Tt);var n=t.options,r=t.meta;if(t.type===K.track){var i=wt(I({event:t.event,properties:t.properties},Object.keys(n).length&&{options:n},{meta:r}));return I({},e,{last:i,history:e.history.concat(i)})}return e}var Dt={actions:[]};function Ot(e,t){e===void 0&&(e=Dt);var n=t.payload;switch(t.type){case`queue`:var r;return r=n&&n.type&&n.type===K.identify?[t].concat(e.actions):e.actions.concat(t),I({},e,{actions:r});case`dequeue`:return[];default:return e}}var kt=/#.*$/;function At(e){var t=/(http[s]?:\/\/)?([^\/\s]+\/)(.*)/g.exec(e);return`/`+(t&&t[3]?t[3].split(`?`)[0].replace(kt,``):``)}var jt,Mt,Nt,Pt,Ft=function(e){if(e===void 0&&(e={}),!w)return e;var t=document,n=t.title,r=t.referrer,i=window,a=i.location,o=i.innerWidth,s=i.innerHeight,c=a.hash,l=a.search,u=function(e){var t=function(){if(w){for(var e,t=document.getElementsByTagName(`link`),n=0;e=t[n];n++)if(e.getAttribute(`rel`)===`canonical`)return e.getAttribute(`href`)}}();return t?t.match(/\?/)?t:t+e:window.location.href.replace(kt,``)}(l),d={title:n,url:u,path:At(u),hash:c,search:l,width:o,height:s};return r&&r!==``&&(d.referrer=r),I({},d,e)},It={last:{},history:[]};function Lt(e,t){e===void 0&&(e=It);var n=t.options;if(t.type===K.page){var r=wt(I({properties:t.properties,meta:t.meta},Object.keys(n).length&&{options:n}));return I({},e,{last:r,history:e.history.concat(r)})}return e}jt=function(){if(!w)return!1;var e=navigator.appVersion;return~e.indexOf(`Win`)?`Windows`:~e.indexOf(`Mac`)?`MacOS`:~e.indexOf(`X11`)?`UNIX`:~e.indexOf(`Linux`)?`Linux`:`Unknown OS`}(),Mt=w?document.referrer:null,Nt=ke(),Pt=Ae();var Rt={initialized:!1,sessionId:Ne(),app:null,version:null,debug:!1,offline:!!w&&!navigator.onLine,os:{name:jt},userAgent:w?navigator.userAgent:`node`,library:{name:Ge,version:`0.13.1`},timezone:Pt,locale:Nt,campaign:{},referrer:Mt};function zt(e,t){e===void 0&&(e=Rt);var n=e.initialized,r=t.campaign;switch(t.type){case K.campaign:return I({},e,{campaign:r});case K.offline:return I({},e,{offline:!0});case K.online:return I({},e,{offline:!1});default:return n?e:I({},Rt,e,{initialized:!0})}}var Bt=[`plugins`,`reducers`,`storage`];function Vt(e,t,n){if(w){var r=window[(n?`add`:`remove`)+`EventListener`];e.split(` `).forEach(function(e){r(e,t)})}}function Ht(e){var t=Vt.bind(null,`online offline`,function(t){return Promise.resolve(!navigator.onLine).then(e)});return t(!0),function(e){return t(!1)}}function Ut(){return N(Ge,[]),function(e){return function(t,n,r){var i=e(t,n,r),a=i.dispatch;return Object.assign(i,{dispatch:function(e){return j[A][Ge].push(e.action||e),a(e)}})}}}function Wt(e){return function(){return B(B.apply(null,arguments),Ut())}}function Gt(e){return e?ye(e)?e:[e]:[]}function Kt(e,t,n){e===void 0&&(e={});var r,i,a=Ne();return t&&(q[a]=(r=t,i=function(e){for(var t,n=e||Array.prototype.slice.call(arguments),r=0;r<n.length;r++)if(E(n[r])){t=n[r];break}return t}(n),function(e){i&&i(e),r(e)})),I({},e,{rid:a,ts:new Date().getTime()},t?{hasCallback:!0}:{})}function qt(e){e===void 0&&(e={});var t=e.reducers||{},n=e.initialUser||{},r=(e.plugins||[]).reduce(function(e,t){if(E(t))return e.middlewares=e.middlewares.concat(t),e;if(t.NAMESPACE&&(t.name=t.NAMESPACE),!t.name)throw Error(`https://lytics.dev/errors/1`);t.config||={};var n=t.EVENTS?Object.keys(t.EVENTS).map(function(e){return t.EVENTS[e]}):[];e.pluginEnabled[t.name]=!(!1===t.enabled||!1===t.config.enabled),delete t.enabled,t.methods&&(e.methods[t.name]=Object.keys(t.methods).reduce(function(e,n){var r;return e[n]=(r=t.methods[n],function(){for(var e=Array.prototype.slice.call(arguments),t=Array(r.length),n=0;n<e.length;n++)t[n]=e[n];return t[t.length]=b,r.apply({instance:b},t)}),e},{}),delete t.methods);var r=Object.keys(t).concat(n),i=new Set(e.events.concat(r));if(e.events=Array.from(i),e.pluginsArray=e.pluginsArray.concat(t),e.plugins[t.name])throw Error(t.name+`AlreadyLoaded`);return e.plugins[t.name]=t,e.plugins[t.name].loaded||(e.plugins[t.name].loaded=function(){return!0}),e},{plugins:{},pluginEnabled:{},methods:{},pluginsArray:[],middlewares:[],events:[]}),i=e.storage?e.storage:{getItem:M,setItem:N,removeItem:P},a=function(e){return function(t,n,r){return n.getState(`user`)[t]||(r&&k(r)&&r[t]?r[t]:$e(e)[t]||M(et(t))||null)}}(i),o=r.plugins,s=r.events.filter(function(e){return!qe.includes(e)}).sort(),c=new Set(s.concat(Ke).filter(function(e){return!qe.includes(e)})),l=Array.from(c).sort(),u=function(){return o},d=new bt,f=d.addMiddleware,p=d.removeMiddleware,m=d.dynamicMiddlewares,h=function(){throw Error(`Abort disabled inListener`)},g=je(),_=$e(i),v=I({},_,n,g.an_uid?{userId:g.an_uid}:{},g.an_aid?{anonymousId:g.an_aid}:{});v.anonymousId||=Ne();var y=I({enable:function(e,t){return new Promise(function(n){S.dispatch({type:K.enablePlugin,plugins:Gt(e),_:{originalAction:K.enablePlugin}},n,[t])})},disable:function(e,t){return new Promise(function(n){S.dispatch({type:K.disablePlugin,plugins:Gt(e),_:{originalAction:K.disablePlugin}},n,[t])})}},r.methods),ee=!1,b={identify:function(e,t,n,r){try{var i=D(e)?e:null,o=k(e)?e:t,s=n||{},c=b.user();N(et(W),i);var l=i||o.userId||a(W,b,o);return Promise.resolve(new Promise(function(e){S.dispatch(I({type:K.identifyStart,userId:l,traits:o||{},options:s,anonymousId:c.anonymousId},c.id&&c.id!==i&&{previousId:c.id}),e,[t,n,r])}))}catch(e){return Promise.reject(e)}},track:function(e,t,n,r){try{var i=k(e)?e.event:e;if(!i||!D(i))throw Error(`EventMissing`);var o=k(e)?e:t||{},s=k(n)?n:{};return Promise.resolve(new Promise(function(e){S.dispatch({type:K.trackStart,event:i,properties:o,options:s,userId:a(W,b,t),anonymousId:a(G,b,t)},e,[t,n,r])}))}catch(e){return Promise.reject(e)}},page:function(e,t,n){try{var r=k(e)?e:{},i=k(t)?t:{};return Promise.resolve(new Promise(function(o){S.dispatch({type:K.pageStart,properties:Ft(r),options:i,userId:a(W,b,r),anonymousId:a(G,b,r)},o,[e,t,n])}))}catch(e){return Promise.reject(e)}},user:function(e){if(e===W||e===`id`)return a(W,b);if(e===G||e===`anonId`)return a(G,b);var t=b.getState(`user`);return e?(0,De.default)(t,e):t},reset:function(e){return new Promise(function(t){S.dispatch({type:K.resetStart},t,e)})},ready:function(e){return ee&&e({plugins:y,instance:b}),b.on(K.ready,function(t){e&&e(t),ee=!0})},on:function(e,t){if(!e||!E(t))return!1;if(e===K.bootstrap)throw Error(`.on disabled for `+e);var n=/Start$|Start:/;if(e===`*`){var r=function(e){return function(e){return function(r){return r.type.match(n)&&t({payload:r,instance:b,plugins:o}),e(r)}}},i=function(e){return function(e){return function(r){return r.type.match(n)||t({payload:r,instance:b,plugins:o}),e(r)}}};return f(r,Jt),f(i,Yt),function(){p(r,Jt),p(i,Yt)}}var a=e.match(n)?Jt:Yt,s=function(n){return function(n){return function(r){return r.type===e&&t({payload:r,instance:b,plugins:o,abort:h}),n(r)}}};return f(s,a),function(){return p(s,a)}},once:function(e,t){if(!e||!E(t))return!1;if(e===K.bootstrap)throw Error(`.once disabled for `+e);var n=b.on(e,function(e){t({payload:e.payload,instance:b,plugins:o,abort:h}),n()});return n},getState:function(e){var t=S.getState();return e?(0,De.default)(t,e):Object.assign({},t)},dispatch:function(e){var t=D(e)?{type:e}:e;if(Ke.includes(t.type))throw Error(`reserved action `+t.type);var n=I({},t,{_:I({originalAction:t.type},e._||{})});S.dispatch(n)},enablePlugin:y.enable,disablePlugin:y.disable,plugins:y,storage:{getItem:i.getItem,setItem:function(e,t,n){S.dispatch({type:K.setItemStart,key:e,value:t,options:n})},removeItem:function(e,t){S.dispatch({type:K.removeItemStart,key:e,options:t})}},setAnonymousId:function(e,t){b.storage.setItem(V,e,t)},events:{core:Ke,plugins:s}},te=r.middlewares.concat([function(e){return function(e){return function(t){return t.meta||=Kt(),e(t)}}},m(Jt),vt(b,u,{all:l,plugins:s}),yt(i),Ze(b),tt(b),m(Yt)]),ne={context:zt,user:Qe(i),page:Lt,track:Et,plugins:xt(u),queue:Ot},re=B,x=B;if(w&&e.debug){var ie=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;ie&&(re=ie({trace:!0,traceLimit:25})),x=function(){return arguments.length===0?Ut():k(typeof arguments[0])?Wt():Wt().apply(null,arguments)}}var ae,oe=function(e){return Object.keys(e).reduce(function(t,n){return Bt.includes(n)||(t[n]=e[n]),t},{})}(e),se={context:oe,user:v,plugins:r.pluginsArray.reduce(function(e,t){var n=t.name,i=t.config,a=t.loaded,o=r.pluginEnabled[n];return e[n]={enabled:o,initialized:!!o&&!t.initialize,loaded:!!a({config:i}),config:i},e},{})},S=He(function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];typeof e[i]===L&&(n[i]=e[i])}var a,o=Object.keys(n);try{(function(e){Object.keys(e).forEach(function(t){var n=e[t];if(typeof n(void 0,{type:Re})===R||typeof n(void 0,{type:ze})===R)throw Error(z+` `+t+` `+R)})})(n)}catch(e){a=e}return function(e,t){if(e===void 0&&(e={}),a)throw a;for(var r=!1,i={},s=0;s<o.length;s++){var c=o[s],l=e[c],u=(0,n[c])(l,t);if(typeof u===R){var d=Ue(c,t);throw Error(d)}i[c]=u,r||=u!==l}return r?i:e}}(I({},ne,t)),se,x(re(We.apply(void 0,te))));S.dispatch=(ae=S.dispatch,function(e,t,n){var r=I({},e,{meta:Kt(e.meta,t,Gt(n))});return ae.apply(null,[r])});var C=Object.keys(o);S.dispatch({type:K.bootstrap,plugins:C,config:oe,params:g,user:v,initialUser:n,persistedUser:_});var ce=C.filter(function(e){return r.pluginEnabled[e]}),le=C.filter(function(e){return!r.pluginEnabled[e]});return S.dispatch({type:K.registerPlugins,plugins:C,enabled:r.pluginEnabled}),r.pluginsArray.map(function(e,t){var n=e.bootstrap,i=e.config,a=e.name;n&&E(n)&&n({instance:b,config:i,payload:e}),S.dispatch({type:K.registerPluginType(a),name:a,enabled:r.pluginEnabled[a],plugin:e}),r.pluginsArray.length===t+1&&S.dispatch({type:K.initializeStart,plugins:ce,disabled:le})}),Ht(function(e){S.dispatch({type:e?K.offline:K.online})}),function(e,t,n){setInterval(function(){return at(e,t,n)},3e3)}(S,u,b),b}var Jt=`before`,Yt=`after`,Xt=`cookie`,X=en(),Zt=tn,Qt=tn;function $t(e){return X?tn(e,``,-1):P(e)}function en(){if(X!==void 0)return X;var e=Xt+Xt;try{tn(e,e),X=document.cookie.indexOf(e)!==-1,$t(e)}catch{X=!1}return X}function tn(e,t,n,r,i,a){if(typeof window<`u`){var o=arguments.length>1;return!1===X&&(o?N(e,t):M(e)),o?document.cookie=e+`=`+encodeURIComponent(t)+(n?`; expires=`+new Date(+new Date+1e3*n).toUTCString()+(r?`; path=`+r:``)+(i?`; domain=`+i:``)+(a?`; secure`:``):``):decodeURIComponent(((`; `+document.cookie).split(`; `+e+`=`)[1]||``).split(`;`)[0])}}var Z=`localStorage`,nn=Ie.bind(null,Z);F(Z,`getItem`,M),F(Z,`setItem`,N),F(Z,`removeItem`,P);var Q=`sessionStorage`,rn=Ie.bind(null,Q);F(Q,`getItem`,M),F(Q,`setItem`,N),F(Q,`removeItem`,P);function $(e){var t=e;try{if((t=JSON.parse(e))===`true`)return!0;if(t===`false`)return!1;if(k(t))return t;parseFloat(t)===t&&(t=parseFloat(t))}catch{}if(t!==null&&t!==``)return t}var an=nn(),on=rn(),sn=en();function cn(e,t){if(e){var n=dn(t),r=!hn(n),i=fn(n)?$(localStorage.getItem(e)):void 0;if(r&&!O(i))return i;var a=pn(n)?$(Zt(e)):void 0;if(r&&a)return a;var o=mn(n)?$(sessionStorage.getItem(e)):void 0;if(r&&o)return o;var s=M(e);return r?s:{localStorage:i,sessionStorage:o,cookie:a,global:s}}}function ln(e,t,n){if(e&&!O(t)){var r={},i=dn(n),a=JSON.stringify(t),o=!hn(i);return fn(i)&&(r.localStorage=_n(`localStorage`,t,$(localStorage.getItem(e))),localStorage.setItem(e,a),o)?r[Z]:pn(i)&&(r.cookie=_n(`cookie`,t,$(Zt(e))),Qt(e,a),o)?r[Xt]:mn(i)&&(r.sessionStorage=_n(`sessionStorage`,t,$(sessionStorage.getItem(e))),sessionStorage.setItem(e,a),o)?r[Q]:(r[Pe]=_n(Pe,t,M(e)),N(e,t),o?r[Pe]:r)}}function un(e,t){if(e){var n=dn(t),r=cn(e,`*`),i={};return!O(r.localStorage)&&fn(n)&&(localStorage.removeItem(e),i.localStorage=r.localStorage),!O(r.cookie)&&pn(n)&&($t(e),i.cookie=r.cookie),!O(r.sessionStorage)&&mn(n)&&(sessionStorage.removeItem(e),i.sessionStorage=r.sessionStorage),!O(r.global)&&gn(n,`global`)&&(P(e),i.global=r.global),i}}function dn(e){return e?D(e)?e:e.storage:`any`}function fn(e){return an&&gn(e,`localStorage`)}function pn(e){return sn&&gn(e,`cookie`)}function mn(e){return on&&gn(e,`sessionStorage`)}function hn(e){return e===`*`||e===`all`}function gn(e,t){return e===`any`||e===t||hn(e)}function _n(e,t,n){return{location:e,current:t,previous:n}}var vn={setItem:ln,getItem:cn,removeItem:un};function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function xn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?bn(Object(n),!0).forEach(function(t){yn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Sn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return qt(xn(xn({},{storage:vn}),e))}var Cn=!0,wn=Sn({debug:!1,app:`hexlet`,version:100,plugins:[b({counterId:`25559621`,enabled:Cn,mapEvents:{signed_up:`ym-register`,signed_in:`ym-login`,program_started:`ym-start-course`,lead_created:`ym-submit-leadform`,email_confirmed:`ym-confirm-contact`}}),ee({sdkInit:{writeKey:`Basic MGZhYjE5OTktZGM0Yy00NDVjLWJiNjQtZWI5MzhkMzFjOGI4OjQ0NjkzZWFlNzE4MmQ3NDE=`},enabled:Cn})]});export{wn as t};